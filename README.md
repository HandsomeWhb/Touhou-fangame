# Touhou-fangame

本游戏支持弹幕,敌人,行动方式的数据驱动,下面将说明数据驱动文件说明方法



**(游戏区域为(320,0)到(1600,1600),左上角是原点,向右是x轴,向下是y轴)**

1.弹幕的数据驱动

assets/data/danmaku目录下写json文件,有两种格式

**注释一定要删!!!**

(1).随机弹幕格式

`{`
  `"generate_random": {`
    `"angle_start": 0.0,     //角度范围,向下为0度,顺时针角度增加`
    `"angle_end": 360.0,`
    `"speed": 5.0,  //弹幕基准速度`
    `"speed_variation": 1.0,//弹幕变化速度(上下浮动,4-6)`
    `"total_bullets": 100,//弹幕总数`
    `"type": "fixed",         //弹幕类型,有fixed(固定弹)aim(自机狙)track(追踪弹)三种,不过这种随机弹幕模式只推荐fixed      
    "frame_start": 0,(随机弹幕开始时间(调用后的相对帧数时间,每秒60帧))`
    `"frame_end": 300,(随机弹幕结束时间)`
    `"remove_on_death": false(是否会在敌人死后清除)`
  `}`
`}`

(2).自定义弹幕逻辑(可不按照时间顺序写,没有特殊要求的部分可以不写)

`[`
  `{`
    `"frame": 0,                    *必须写//弹幕开始时间(调用后的相对帧数时间,每秒60帧)`				
    `"type": "fixed",               默认0 // 例："fixed", "aim", "trace"`
    `"angle": 45.0,                 默认0//fixed射击角度/aim角度偏差`
    `"speed": 3.0,                  默认0//整体速度`
    `"position_x": 400.0,           默认0//发射坐标,相对于敌人`
    `"position_y": 300.0,`
    `"aim_offset_x": 0.0,           默认0// 目标瞄准偏移`
    `"aim_offset_y": 0.0,`
    `"exist_time": 9999,            默认9999//存在时间(帧数)`
    `"remove_on_death": false      默认false//是否会在敌人死后消失`
  `},`

`{`

`...`//与上面类似,支持扩展

`}`

`]`

2.行为模式的数据驱动(必须按照时间顺序写)

assets/data/move目录下写json文件

`[`
  `{`
    `"frame": 2,                  //出场帧数(敌人出现后的相对帧数时间,每秒60帧)`
    `"angle": 90.0,              //移动角度,向下为0度,顺时针角度增加`
    `"speed": 3.0               //移动速度`
  `},`
  `{`

`...`

`}`
`]`

3.敌人的数据驱动(无需按顺序写)

assets/data/enemy/v2目录下写json文件

[
  {
    "num": 3,//创建一波敌人,这波敌人有三个
    "appear_frame": 600,//游戏开始后第600帧出场
    "frame_interval": 20,//每个敌人间隔20帧
    "enemy": {
      "type": "Red_enemy",//敌人种类
      "hp": 200.0,//敌人血量
      "x": 960.0,//敌人出场位置,区域320,0到1600,1600
      "y": 400.0,
      "rewards": {//可不写,不写则随机生成
        "power": 1,//小p点
        "big_power": 0,//大p点
        "bomb_up": 0,//炸弹
        "health_up": 1,//生命
        "blue_point": 5//蓝点
      }
    },
    "fire_plan": [
      {//发射的弹幕,支持从多个文件里面加载,相同参数的优先级高于弹幕文件里面的
        "remove_on_death": true,//弹幕文件里也有这个参数,如果这里写了则优先采用这里的,并将这个弹幕文件里所有的这项配置修改为这里的值,也可不写,则采用弹幕文件里的配置
        "danmaku_offset_angle": 45,//整个弹幕绕敌人顺时针旋转的度数
        "danmaku_start_frame": 60,//敌人出现后第60帧调用这个弹幕文件
        "shoot_logic": "test.json",//调用前面写的名为test.json弹幕文件
        "type": "Star",//弹幕形状
        "global_speed": 4,//把弹幕文件里的所有速度修改为4,也可不写,不写则用弹幕文件的值
        "color": {//弹幕颜色,rgba4通道
          "r": 255,
          "g": 0,
          "b": 0,
          "a": 255
        }
      },
      {
        ...//同上
        }
      }
    ],
    "move": "move.json"//用前面名为move.json的文件里的移动逻辑
  }
]
